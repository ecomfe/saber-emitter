<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>AspectEmitter usage</title>
        <script src="http://s1.bdstatic.com/r/www/cache/ecom/esl/1-6-10/esl.js"></script>
    </head>
    <body>
        <p>please view source &amp; console's output.</p>
        <script>
        require.config({
            packages: [
                {
                    name: 'saber-emitter',
                    location: '../src',
                    main: 'emitter'
                }
            ]
        });
        require( [ 'saber-emitter/aspect' ], function( AspectEmitter ) {
            var emitter = new AspectEmitter();

            function greeting( name ) {
                console.log( 'Hello, ' + name + '!' );
            }

            function greetingBefore( name ) {
                console.log( 'before: Hello, ' + name + '!' );
            }

            function greetingAfter( name ) {
                console.log( 'after: Hello, ' + name + '!' );
            }

            // add listener
            emitter.on( 'greeting', greeting);

            // add AOP
            emitter.on( 'greeting:before', greetingBefore );
            emitter.on( 'greeting:after', greetingAfter );

            // output:
            // before: Hello, Firede!
            // Hello, Firede!
            // after: Hello, Firede!
            emitter.emit( 'greeting', 'Firede' );

            // remove after AOP
            emitter.off( 'greeting:after' );

            // output:
            // before: Hello, zfkun!
            // Hello, zfkun!
            emitter.emit( 'greeting', 'zfkun' );

            // remove listener and AOP
            // you need remove AOP manually
            emitter.off( 'greeting' );
            emitter.off( 'greeting:before' );

            // do nothing ( listener has been removed )
            emitter.emit( 'greeting', 'World' );

            // add listener just emit once
            emitter.once( 'hi', greeting );

            // add aop just emit once
            emitter.once( 'hi:before', greetingBefore );

            // do nothing ( listener has been removed after called )
            emitter.once( 'hi:after', greetingAfter );

            // output:
            // before: Hello, EcomFE!
            // Hello, EcomFE!
            emitter.emit( 'hi', 'EcomFE' );

            // do nothing ( listener has been removed )
            emitter.emit( 'hi', 'World' );
        });
        </script>
    </body>
</html>